# 单元测试分享

1. 单元测试，什么是单元，集成测试，系统测试  （去除所有依赖）
> 对于面向对象来说，单元就是方法，单元测试就是对一个个的方法进行测试，除了这个方法之外的所有所有不可靠的外部依赖都不属于对这个单元。所以需要进行一些手段进行一个模拟。

2. 单元测试的目的是什么
> 单元测试写起来费时费力，对于快速迭代，随时响应变化的需求来说，今天写的单元测试可能明天就改了，那写单元测试还有意义吗？

2.1 基本的，减少代码出bug的概率，提高提测质量

> 进行完单元测试的代码，这段代码的基本的逻辑，应该完成的功能是经过校验的，在进行编写测试用例的时候我们就对这段代码进行多次的review，所以在进行自测，联调的时候会产生更少的bug

2.2 提高代码的可读性
> 在编写单测的时候，会多次考虑这个方法他的作用是什么，我需要测试几个方面。方法的作用以及影响会逐渐清晰起来。单测就是最好的一个doc。

2.3 加强对业务的理解
> 需要对需求的核心目的进行确认，才能更好的辨认出那些是不变的，哪些是核心逻辑需要全面测试，哪些是不稳定的需求。


3. 我的实践

3.1 代码的可测试性
> 代码的可测试性。编写尽量简单的类和函数。进行使用组合的方式。。。。。

> 1. 过多的职责。获取数据，进行处理，进行转化。。。合并到了一起
> 2. 过多的逻辑分支,代码逻辑在同一个class中的私有小方法中
> 3. 层级结构混乱，一个service

3.2 单元测试要测试哪几种情况
> 1. 正常的流程
> 2. 可能出现异常的流程
> 3. 边界条件

3.3 单元测试的具体代码
> mock stub spy fake 的应用
> given when then 
> 好代码 和 差代码的不同单元测试代码
> 单元测试的命名一定要精确，避免出现test() 这种命名
> 一个test方法应该只测一种情况
> 使用断言而不是使用 System.out.println()
> 单元测试应该运行速度很快，建议单个应用的单元测试执行时间不超过10分钟
> 开始写单测可能出现的问题

3.4 单元测试的覆盖问题，所有方法必须要测试吗
> 肯定是不需要的。按照需要进行一个测试，一个Bean类，或者一个基本上只是调用mapper 层一个select方法的方法。。。。

3.5 测试先行的思想
> 在编写代码之前就要开始想如何写才比较容易测试。

3.6 分析需求并进行任务分解的能力
> 业务价值——>业务功能——>业务实现

4. TDD  
4.1 TDD 的图及解释

4.2 尝试性的TDD
> 1. 需求分析
> 2. 开始设计
> 3. 编写基本的接口及方法，明确起定义。空实现
> 4. 编写单元测试
> 5. 进行实现，重构，修改单元测试。循环。
> 6. 跑过单元测试，自测，联调。
> 
> 出现的问题。1. 第4步不好做。2. 容易开始就扎到细节中去。

5. 发散下 , 函数式编程 及 DDD 。
6. 大家的一些想法。 